<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Changelog" href="../CHANGELOG.html"><link rel="prev" title="Widom Class" href="../input_description/widom.html">
        <link rel="prefetch" href="../_static/logo-light-mode.png" as="image">
        <link rel="prefetch" href="../_static/logo-dark-mode.png" as="image">

    <link rel="shortcut icon" href="../_static/favicon.ico"><!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Widom insertion - FLAMES v0.4.4</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">FLAMES v0.4.4</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo-light-mode.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo-dark-mode.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing FLAMES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input Description</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../input_description/base_simulator.html">BaseSimulator Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_description/gcmc.html">GCMC Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_description/widom.html">Widom Class</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials: Basic</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Widom insertion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference external" href="https://raw.githubusercontent.com/lipelopesoliveira/flames/main/LICENSE">License</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lipelopesoliveira/flames">GitHub Repository</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/basic_widom.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="widom-insertion">
<h1>Widom insertion<a class="headerlink" href="#widom-insertion" title="Link to this heading">¶</a></h1>
<section id="breafly-introduction-about-widom-insertion-method">
<h2>Breafly introduction about Widom insertion method<a class="headerlink" href="#breafly-introduction-about-widom-insertion-method" title="Link to this heading">¶</a></h2>
<p>The Widom insertion method is a powerful and computationally efficient technique in statistical mechanics used to calculate the excess chemical potential of a species at infinite dilution. The method operates by inserting a “ghost” or “test” particle at random positions and orientations within a static configuration of a host system, such as a porous material. For each insertion, the interaction energy between the ghost particle and the host is calculated, but the particle is not actually added, so the host’s configuration remains unchanged. By averaging the Boltzmann factor of these interaction energies over thousands or millions of trials, one can directly compute the <strong>Henry’s constant</strong>, which is fundamentally related to the material’s affinity for the adsorbate at low pressures, and the <strong>Isosteric Heat of Adsorption at zero coverage (Qst)</strong>. Furthermore, the distribution of insertion energies reveals the potential energy landscape, identifying the coordinates of the most stable adsorption sites within the framework.</p>
<p>This makes the Widom method arguably the easiest and most direct way to test a new Machine Learning Potential (MLP) for adsorption applications. Unlike full Grand Canonical Monte Carlo simulations, it does not require lengthy equilibration or the simulation of multiple interacting guest molecules. The method yields two crucial, physically meaningful metrics: the most stable binding configurations and the enthalpy of adsorption. These two outputs can be directly compared with high-fidelity experimental data from microcalorimetry and diffraction techniques, or with results from expensive quantum mechanical calculations, providing a robust and computationally inexpensive first-pass validation of the MLP’s accuracy in describing host-guest interactions.</p>
</section>
<hr class="docutils" />
<section id="setting-the-stage">
<h2>Setting the stage<a class="headerlink" href="#setting-the-stage" title="Link to this heading">¶</a></h2>
<p>In this example we will evaluate the Mg-MOF-74, a material well-known for having adsorption of CO <sub>2</sub> on Open-Metal sites, which is very hard to model with classical force fields and usually require electronic structure methods, such DFT, to describe the interaction properly.</p>
<p>On the <code class="docutils literal notranslate"><span class="pre">flames/examples/Basic/1-Widom</span></code> folder you will find the <code class="docutils literal notranslate"><span class="pre">cif</span></code> file for the Mg-MOF-74 <a class="footnote-reference brackets" href="#id3" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. The simulation will be executed with the machine learning potential MACE <a class="footnote-reference brackets" href="#id4" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, using the <code class="docutils literal notranslate"><span class="pre">medium-0b2</span></code> pre-trained foundation model with <code class="docutils literal notranslate"><span class="pre">D3(0)</span></code> dispersion correction.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This model is used here just as an example, you should look carefully into the mace documentation to undestand how the potential work and which one is the best for your specific case.</p>
</div>
<p>The script below will run the simulation at 298 K (25°C).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="c1"># Hide UserWarning and RuntimeWarning messages</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ase</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">vdw_radii</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">read</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mace.calculators</span><span class="w"> </span><span class="kn">import</span> <span class="n">mace_mp</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">flames.widom</span><span class="w"> </span><span class="kn">import</span> <span class="n">Widom</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;KMP_DUPLICATE_LIB_OK&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;TRUE&quot;</span>

<span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">mace_mp</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;medium-0b2&quot;</span><span class="p">,</span>
    <span class="n">dispersion</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">damping</span><span class="o">=</span><span class="s2">&quot;zero&quot;</span><span class="p">,</span>  <span class="c1"># choices: [&quot;zero&quot;, &quot;bj&quot;, &quot;zerom&quot;, &quot;bjm&quot;]</span>
    <span class="n">dispersion_xc</span><span class="o">=</span><span class="s2">&quot;pbe&quot;</span><span class="p">,</span>
    <span class="n">default_dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">FrameworkPath</span> <span class="o">=</span> <span class="s2">&quot;mg-mof-74.cif&quot;</span>
<span class="n">AdsorbatePath</span> <span class="o">=</span> <span class="s2">&quot;co2.xyz&quot;</span>

<span class="c1"># Load the framework structure</span>
<span class="n">framework</span><span class="p">:</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">FrameworkPath</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

<span class="c1"># Load the adsorbate structure</span>
<span class="n">adsorbate</span><span class="p">:</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">AdsorbatePath</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

<span class="n">Temperature</span> <span class="o">=</span> <span class="mf">298.0</span>

<span class="n">NSteps</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="n">widom</span> <span class="o">=</span> <span class="n">Widom</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">framework_atoms</span><span class="o">=</span><span class="n">framework</span><span class="p">,</span>
    <span class="n">adsorbate_atoms</span><span class="o">=</span><span class="n">adsorbate</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="n">Temperature</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
    <span class="n">vdw_radii</span><span class="o">=</span><span class="n">vdw_radii</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">output_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">cutoff_radius</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span>
    <span class="n">automatic_supercell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">widom</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">print_header</span><span class="p">()</span>

<span class="n">widom</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">NSteps</span><span class="p">)</span>
<span class="n">widom</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
<span class="n">widom</span><span class="o">.</span><span class="n">save_results</span><span class="p">()</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="breaking-down-the-input-script">
<h2>Breaking down the input script<a class="headerlink" href="#breaking-down-the-input-script" title="Link to this heading">¶</a></h2>
<section id="importing-libraries">
<h3>Importing libraries<a class="headerlink" href="#importing-libraries" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="c1"># Hide UserWarning and RuntimeWarning messages</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ase</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">vdw_radii</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">read</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mace.calculators</span><span class="w"> </span><span class="kn">import</span> <span class="n">mace_mp</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">flames.widom</span><span class="w"> </span><span class="kn">import</span> <span class="n">Widom</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;KMP_DUPLICATE_LIB_OK&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;TRUE&quot;</span>
</pre></div>
</div>
<p>This first part only import the libraries and make the code to ignore a few non-important warnings from mace.
The <code class="docutils literal notranslate"><span class="pre">os.environ[&quot;KMP_DUPLICATE_LIB_OK&quot;]</span> <span class="pre">=</span> <span class="pre">&quot;TRUE&quot;</span></code> command is ony important on Windows machines. If you are running on Linux, this command will just be ignored.</p>
<p>Here the <code class="docutils literal notranslate"><span class="pre">vdw_radii</span></code> from <code class="docutils literal notranslate"><span class="pre">ase.data</span></code> is imported to calculate the smaller distance allowed between two atoms.</p>
</section>
<hr class="docutils" />
<section id="defining-the-calculator">
<h3>Defining the calculator<a class="headerlink" href="#defining-the-calculator" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">mace_mp</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;medium-0b2&quot;</span><span class="p">,</span>
    <span class="n">dispersion</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">damping</span><span class="o">=</span><span class="s2">&quot;zero&quot;</span><span class="p">,</span>  <span class="c1"># choices: [&quot;zero&quot;, &quot;bj&quot;, &quot;zerom&quot;, &quot;bjm&quot;]</span>
    <span class="n">dispersion_xc</span><span class="o">=</span><span class="s2">&quot;pbe&quot;</span><span class="p">,</span>
    <span class="n">default_dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This is an extremelly important part, as the <code class="docutils literal notranslate"><span class="pre">calculator</span></code> will be used to calculate the energy of interaction between the adsorbate (CO2) and the adsorbent (Mg-MOF-74).
If you are running on GPU (which is extremelly recommended) you need to define the device correctly, so the calculator use the GPU. Currently, basically all MLPs only use a single GPU.</p>
<p>Here the pre-trained model <code class="docutils literal notranslate"><span class="pre">medium-0b2</span></code> is used, but currently there are several other variations available. For a complete list, check the mace-foundation repository: <a class="reference external" href="https://github.com/ACEsuit/mace-foundations">https://github.com/ACEsuit/mace-foundations</a>.</p>
<p>For a list of available models, check <a class="reference external" href="https://github.com/ACEsuit/mace/blob/100a29149d90a5945eddec1f0940bd88a6e3b363/mace/calculators/foundations_models.py#L19">https://github.com/ACEsuit/mace/blob/100a29149d90a5945eddec1f0940bd88a6e3b363/mace/calculators/foundations_models.py#L19</a>. You can also run a local model, just passing the path of the model instead of the name to the variable <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p>
</section>
<section id="reading-the-structure">
<h3>Reading the structure<a class="headerlink" href="#reading-the-structure" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">FrameworkPath</span> <span class="o">=</span> <span class="s2">&quot;mg-mof-74.cif&quot;</span>
<span class="n">AdsorbatePath</span> <span class="o">=</span> <span class="s2">&quot;co2.xyz&quot;</span>

<span class="c1"># Load the framework structure</span>
<span class="n">framework</span><span class="p">:</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">FrameworkPath</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

<span class="c1"># Load the adsorbate structure</span>
<span class="n">adsorbate</span><span class="p">:</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">AdsorbatePath</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</pre></div>
</div>
<p>This part of the code will read the framework and the adsorbate files. It uses the <code class="docutils literal notranslate"><span class="pre">read</span></code> function from <code class="docutils literal notranslate"><span class="pre">ase</span></code>, which is very powerful and can read most file formats.
Here, just make sure that the framework file is in a file format that is compatible with periodic boundary conditions and has a unt cell correctly defined.</p>
<p>In case you want to make sure that your framework was read properly, you can create a separate python script and visualize the structure with the <code class="docutils literal notranslate"><span class="pre">ase</span></code> visualizator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ase.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">read</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.visualize</span><span class="w"> </span><span class="kn">import</span> <span class="n">view</span>

<span class="n">FrameworkPath</span> <span class="o">=</span> <span class="s2">&quot;mg-mof-74.cif&quot;</span>

<span class="c1"># Load the framework structure</span>
<span class="n">framework</span><span class="p">:</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">FrameworkPath</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

<span class="c1"># Visualize the framework structure</span>
<span class="n">view</span><span class="p">(</span><span class="n">framework</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="running-the-simulation">
<h3>Running the simulation<a class="headerlink" href="#running-the-simulation" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Temperature</span> <span class="o">=</span> <span class="mf">298.0</span>
<span class="n">NSteps</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="n">widom</span> <span class="o">=</span> <span class="n">Widom</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">framework_atoms</span><span class="o">=</span><span class="n">framework</span><span class="p">,</span>
    <span class="n">adsorbate_atoms</span><span class="o">=</span><span class="n">adsorbate</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="n">Temperature</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
    <span class="n">vdw_radii</span><span class="o">=</span><span class="n">vdw_radii</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">output_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">cutoff_radius</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span>
    <span class="n">automatic_supercell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">widom</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">print_header</span><span class="p">()</span>

<span class="n">widom</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">NSteps</span><span class="p">)</span>
<span class="n">widom</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
<span class="n">widom</span><span class="o">.</span><span class="n">save_results</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, this block defines the <code class="docutils literal notranslate"><span class="pre">widom</span></code> simulator and runs the code. You can define the <code class="docutils literal notranslate"><span class="pre">Temperature</span></code> and the number of Monte Carlo steps <code class="docutils literal notranslate"><span class="pre">NSteps</span></code>.</p>
<p>Here we are using 3.000 for example, but it is recommended that you use way more steps for a serious simulations, and check if in fact your results are equilibrated. Usually 100.000 is a good starting point, but it strongly depends on the system.</p>
<p>You should change the <code class="docutils literal notranslate"><span class="pre">cutoff_radius</span></code> according to your system and potential used, usually 6.0 Å is a good starting point but check carefully the cutoff of your potential.
The <code class="docutils literal notranslate"><span class="pre">automatic_supercell</span></code> option will create a supercell big enough to fit the cutoff radius, so you don’t need to worry about that.</p>
</section>
</section>
<section id="analyzing-the-output">
<h2>Analyzing the output<a class="headerlink" href="#analyzing-the-output" title="Link to this heading">¶</a></h2>
<section id="the-header">
<h3>The header<a class="headerlink" href="#the-header" title="Link to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>===========================================================================
         _______  __          ___      .___  ___.  _______     _______.
        |   ____||  |        /   \     |   \/   | |   ____|   /       |
        |  |__   |  |       /  ^  \    |  \  /  | |  |__     |   (----`
        |   __|  |  |      /  /_\  \   |  |\/|  | |   __|     \   \
        |  |     |  `----./  _____  \  |  |  |  | |  |____.----)   |
        |__|     |_______/__/     \__\ |__|  |__| |_______|_______/

        Flexible Lattice Adsorption by Monte Carlo Engine Simulation
                        powered by Python + ASE
                    Author: Felipe Lopes de Oliveira
===========================================================================

Code version: 0.4.4
Simulation started at 2025-11-17 23:06:46
Hostname: felipe-Dell-G16-7630
OS type: Linux
OS release: 6.7.10-060710-generic
OS version: #202403151538 SMP PREEMPT_DYNAMIC Fri Mar 15 20:14:18 UTC 2024

Python version: 3.12.11
Numpy version: 1.26.4
ASE version: 3.25.0

Current directory: /home/felipe/PRs/flames/examples/Basic/1-Widom
Random Seed: 42

Model: sumcalculator
Running on device: cuda
</pre></div>
</div>
<p>The header will print some information about the code version, the host machine, the python and ASE versions, the current directory, the random seed used, the model and the device used. It is always important to check this information to make sure everything is correct.</p>
</section>
<section id="the-simulation-summary">
<h3>The simulation summary<a class="headerlink" href="#the-simulation-summary" title="Link to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>===========================================================================

Constants used:
Boltzmann constant:     8.617330337217213e-05 eV/K
Beta (1/kT):            38.941 eV^-1
Fugacity coefficient:   0.000000000 (dimensionless)

===========================================================================

Simulation Parameters:
Temperature: 298.0 K
Pressure: 0.00000 bar
Fugacity: 0.000 Pa
Fugacity: 0.00000e+00 eV/m^3
(1/kB.T) * V * f = 0.0 [-]

===========================================================================
</pre></div>
</div>
<p>This block presents the constants used in the simulation, mostly for reference and debugging purposes. It also summarizes the simulation parameters, including temperature, pressure, and fugacity values. For Widom simulations, there is no pressure or fugacity involved, so these values are zero.</p>
</section>
<section id="the-system-information">
<h3>The system information<a class="headerlink" href="#the-system-information" title="Link to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>System Information:
Framework: C144H36Mg36O108
Framework: 324 atoms,
Framework mass: 4368.743999999999 g/mol, 7.254469967765757e-24 kg
Framework energy: -2365.8930653513903 eV
Framework volume: 8.24197326482685e-27 m^3
Framework density: 880.186059171615 kg/m^3, 0.8801860591716151 g/cm^3
Framework cell:
    26.1701000    0.0000000    0.0000000
    13.0850500   22.6639714    0.0000000
    0.0000000    0.0000000   13.8960000

Perpendicular cell:
    22.6639714    0.0000000    0.0000000
    0.0000000   22.6639714    0.0000000
    0.0000000    0.0000000   13.8960000

Atomic positions:
Mg   16.5873945   14.4378564    3.7075223
O     4.8947247    5.7482631    2.3059717
C     5.6694905    4.8079349    1.7135852
...

 H    25.8864161   22.0824139    8.0335555

===========================================================================
Adsorbate: CO2
Adsorbate: 3 atoms, 7.307866261136e-26 kg
Adsorbate energy: -22.788235797845456 eV

Atomic positions:
C     0.0000000    0.0000000    0.0000000
O     1.1606430    0.0000000    0.0000000
O    -1.1606430    0.0000000    0.0000000

===========================================================================
Shortest distances:
O  - H : 1.632 Å
O  - Mg: 1.950 Å
O  - C : 1.932 Å
H  - Mg: 1.758 Å
H  - C : 1.740 Å
Mg - C : 2.058 Å

===========================================================================
Conversion factors:
    Conversion factor molecules/unit cell -&gt; mol/kg:         0.228898741
    Conversion factor molecules/unit cell -&gt; mg/g:           10.073604679
    Conversion factor molecules/unit cell -&gt; cm^3 STP/gr:    5.130527703
    Conversion factor molecules/unit cell -&gt; cm^3 STP/cm^3:  4.515818960
    Conversion factor molecules/unit cell -&gt; %wt:            1.007360468

Partial pressure:
                0.000000000000000 Pascal
                0.000000000000000 bar
                0.000000000000000 atm
                0.000000000000000 Torr
===========================================================================
</pre></div>
</div>
<p>This section provides detailed information about the framework and adsorbate, including their compositions, masses, energies, volumes, densities, and atomic positions.</p>
<p>It also lists the shortest distances between different atom types in the system, which can be useful for understanding potential interactions. Always check these distances to make sure there are no unphysical overlaps or if it does not prevent desired interactions.</p>
<p>Additionally, conversion factors are provided to facilitate the interpretation of simulation results in various units. For Widom simulations these factores are not used, but they are printed for reference.</p>
</section>
<section id="the-simulation">
<h3>The simulation<a class="headerlink" href="#the-simulation" title="Link to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Starting Widom simulation
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Iteration  |  dE (eV)  |  dE (kJ/mol)  | kH [mol kg-1 Pa-1]  |  dH (kJ/mol) | Time (s)
---------------------------------------------------------------------------------------
    1      | -0.049759 |         -4.80 |           1.821e-06 |        -6.67 |     0.52
    2      | -0.118381 |        -11.42 |           1.657e-05 |       -13.37 |     0.61
    3      | -0.156906 |        -15.14 |           6.406e-05 |       -16.79 |     0.15
    4      | -0.031338 |         -3.02 |           5.156e-05 |       -16.72 |     0.15
    5      | -0.034721 |         -3.35 |           4.326e-05 |       -16.65 |     0.30
    6      | -0.117306 |        -11.32 |           4.339e-05 |       -16.24 |     0.15
    7      | -0.077221 |         -7.45 |           3.913e-05 |       -16.05 |     0.15
    8      | -0.076447 |         -7.38 |           3.578e-05 |       -15.88 |     0.30
    9      | -0.077040 |         -7.43 |           3.312e-05 |       -15.71 |     0.15
    10     | -0.142258 |        -13.73 |           4.073e-05 |       -15.84 |     0.15
    11     | -0.184081 |        -17.76 |           8.692e-05 |       -18.35 |     0.17
    12     | -0.074968 |         -7.23 |           8.089e-05 |       -18.28 |     0.15
    13     | -0.233352 |        -22.52 |           3.646e-04 |       -23.61 |     0.15
    14     | -0.084846 |         -8.19 |           3.412e-04 |       -23.58 |     0.16
    15     | -0.068756 |         -6.63 |           3.203e-04 |       -23.56 |     0.31
    16     | -0.313437 |        -30.24 |           5.694e-03 |       -32.23 |     0.15
...
</pre></div>
</div>
<p>Here the main simulation output is presented. For each Widom insertion step, the change in energy (dE) upon inserting the ghost particle is reported in both eV and kJ/mol.
The Henry’s constant (kH) and isosteric heat of adsorption at zero coverage (dH) are calculated based on the average Boltzmann factor of the insertion energies up to that point. The time taken for each insertion step is logged, allowing users to monitor performance.</p>
</section>
<section id="the-results">
<h3>The results<a class="headerlink" href="#the-results" title="Link to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>...
2998    | -0.083372 |         -8.04 |           2.046e+00 |       -53.78 |     0.43
2999    | -0.146298 |        -14.12 |           2.045e+00 |       -53.78 |     0.42
3000    | -0.156466 |        -15.10 |           2.044e+00 |       -53.78 |     0.33

===========================================================================

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finishing Widom simulation
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

    Average properties of the system:
    ------------------------------------------------------------------------------
    Henry coefficient: [mol/kg/Pa]       2.04418e+00 +/-  3.33591e-01 [-]
    Enthalpy of adsorption: [kJ/mol]       -53.78391 +/-      0.34888 [-]

===========================================================================
Simulation finished successfully!
===========================================================================

Simulation finished at 2025-11-17 23:29:43
Simulation duration: 0:13:37.214066
===========================================================================
</pre></div>
</div>
<p>Finally the simulation result is printed, with the average values reported.</p>
<p>Also, a json file is saved with the main results, that can be easily read and processed for further analysis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;code_version&quot;</span><span class="p">:</span> <span class="s2">&quot;0.4.4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;random_seed&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="s2">&quot;enlapsed_time_hours&quot;</span><span class="p">:</span> <span class="mf">0.22700391277777776</span><span class="p">,</span>
    <span class="s2">&quot;total_insertions&quot;</span><span class="p">:</span> <span class="mi">3001</span><span class="p">,</span>
    <span class="s2">&quot;temperature_K&quot;</span><span class="p">:</span> <span class="mf">298.0</span><span class="p">,</span>
    <span class="s2">&quot;henry_coefficient_mol_kg-1_Pa-1&quot;</span><span class="p">:</span> <span class="mf">2.044178342815808</span><span class="p">,</span>
    <span class="s2">&quot;henry_coefficient_std_mol_kg-1_Pa-1&quot;</span><span class="p">:</span> <span class="mf">0.3335905351383779</span><span class="p">,</span>
    <span class="s2">&quot;enthalpy_of_adsorption_kJ_mol-1&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">53.78390928504431</span><span class="p">,</span>
    <span class="s2">&quot;enthalpy_of_adsorption_std_kJ_mol-1&quot;</span><span class="p">:</span> <span class="mf">0.3488799686455756</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Mason, J.A., Sumida, K., Herm, Z.R., Krishna, R. and Long, J.R., 2011. Evaluating metal-organic frameworks for post-combustion carbon dioxide capture via temperature swing adsorption. Energy &amp; Environmental Science, 4(8), pp.3030-3040. <a class="reference external" href="https://pubs.rsc.org/en/content/articlelanding/2011/ee/c1ee01720a">https://pubs.rsc.org/en/content/articlelanding/2011/ee/c1ee01720a</a></p>
</aside>
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Batatia, I., Benner, P., Chiang, Y., Elena, A.M., Kovács, D.P., Riebesell, J., Advincula, X.R., Asta, M., Avaylon, M., Baldwin, W.J. and Berger, F., 2025. A foundation model for atomistic materials chemistry. The Journal of Chemical Physics, 163(18). <a class="reference external" href="https://pubs.aip.org/aip/jcp/article/163/18/184110/3372267/A-foundation-model-for-atomistic-materials">https://pubs.aip.org/aip/jcp/article/163/18/184110/3372267/A-foundation-model-for-atomistic-materials</a></p>
</aside>
</aside>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../CHANGELOG.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Changelog</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../input_description/widom.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Widom Class</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Felipe Lopes de Oliveira
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/lipelopesoliveira/flames" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Widom insertion</a><ul>
<li><a class="reference internal" href="#breafly-introduction-about-widom-insertion-method">Breafly introduction about Widom insertion method</a></li>
<li><a class="reference internal" href="#setting-the-stage">Setting the stage</a></li>
<li><a class="reference internal" href="#breaking-down-the-input-script">Breaking down the input script</a><ul>
<li><a class="reference internal" href="#importing-libraries">Importing libraries</a></li>
<li><a class="reference internal" href="#defining-the-calculator">Defining the calculator</a></li>
<li><a class="reference internal" href="#reading-the-structure">Reading the structure</a></li>
<li><a class="reference internal" href="#running-the-simulation">Running the simulation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#analyzing-the-output">Analyzing the output</a><ul>
<li><a class="reference internal" href="#the-header">The header</a></li>
<li><a class="reference internal" href="#the-simulation-summary">The simulation summary</a></li>
<li><a class="reference internal" href="#the-system-information">The system information</a></li>
<li><a class="reference internal" href="#the-simulation">The simulation</a></li>
<li><a class="reference internal" href="#the-results">The results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=90733dfc"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>